#include <stdio.h>

int main() {
    printf("Chethana.C (1BM23CS077)\n");
    printf("Leaky Bucket Congestion Control Simulator\n\n");

    int n;              
    int capacity;      
    int output_rate;    
    
    printf("Enter number of time units (n): ");
    if (scanf("%d", &n) != 1 || n <= 0) {
        printf("Invalid number of time units.\n");
        return 1;
    }

    printf("Enter bucket capacity (max packets): ");
    if (scanf("%d", &capacity) != 1 || capacity <= 0) {
        printf("Invalid bucket capacity.\n");
        return 1;
    }

    printf("Enter output (leak) rate per time unit: ");
    if (scanf("%d", &output_rate) != 1 || output_rate < 0) {
        printf("Invalid output rate.\n");
        return 1;
    }

    int arrivals[n];
    printf("Enter %d integers: number of arriving packets at each time unit (space separated):\n", n);
    for (int i = 0; i < n; ++i) {
        if (scanf("%d", &arrivals[i]) != 1 || arrivals[i] < 0) {
            printf("Invalid arrival value at index %d.\n", i);
            return 1;
        }
    }

    int bucket = 0;         
    int dropped_total = 0;
    int sent_total = 0;

    printf("\nTime\tArrived\tBucketBefore\tSent\tDropped\tBucketAfter\n");
    printf("----\t-------\t------------\t----\t-------\t-----------\n");

    for (int t = 0; t < n; ++t) {
        int arrived = arrivals[t];
        int before = bucket;

  
        int space_left = capacity - bucket;
        int accepted = (arrived <= space_left) ? arrived : space_left;
        int dropped = arrived - accepted;
        bucket += accepted;
        dropped_total += dropped;

      
        int sent = (bucket <= output_rate) ? bucket : output_rate;
        bucket -= sent;
        sent_total += sent;

        printf("%2d\t%6d\t%12d\t%4d\t%7d\t%11d\n",
               t+1, arrived, before, sent, dropped, bucket);
    }

   
    printf("\nSummary:\n");
    printf("Total packets sent:    %d\n", sent_total);
    printf("Total packets dropped: %d\n", dropped_total);
    printf("Packets remaining in bucket: %d\n", bucket);

    return 0;
}

